// Generated by CoffeeScript 1.8.0
(function() {
  'use strict';
  angular.module('projectApp').controller('electricityCtrl', function($scope, $http, Auth, $location) {
    var userId;
    $scope.getCurrentUser = Auth.getCurrentUser;
    userId = Auth.getCurrentUser()._id;
    $scope.date = new Date();
    $http.get('/api/electricityvalue/findone/' + userId).then(function(value) {
      if (value.data === '' || value.data === null || Object.getOwnPropertyNames(value.data).length === 1) {
        return $scope.prevValue = 0;
      } else {
        return $scope.prevValue = value.data[0].currentValue;
      }
    });
    $http.get('/api/extradata/' + userId).then(function(val) {
      $scope.val = val;
      if ($scope.val.data === '' || $scope.val.data === null) {
        return $scope.customError = true;
      } else {
        $scope.customError = false;
        if ($scope.val.data.meterType === "dubbel") {
          return $scope.meterType = "dubbel";
        }
      }
    });
    return $scope.saveElectricityValues = function(form) {
      var elecValue;
      if ($scope.val.data.meterType === "dubbel") {
        elecValue = parseFloat($scope.dayMeter) + parseFloat($scope.nightMeter);
      } else {
        elecValue = parseFloat($scope.dayMeter);
      }
      $http.post('/api/electricityvalue', {
        measureday: $scope.date,
        currentValue: elecValue,
        previousValue: $scope.prevValue,
        accountId: Auth.getCurrentUser()._id
      });
      return $location.path('/jouwenergie');
    };
  });

}).call(this);

//# sourceMappingURL=electricity.controller.js.map
